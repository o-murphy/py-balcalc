from re import search

import a7p
from PySide6 import QtCore

from py_ballisticcalc import Unit
from py_balcalc.settings import appSettings


# creates, show and store ballistic profile
class Profile(QtCore.QObject):
    def __init__(self, parent=None):
        super(Profile, self).__init__(parent)

        self._z_d = Unit.METER(100)  # zeroing distUnits

        self.z_wind_angle = Unit.DEGREE(0)
        self.z_wind_speed = Unit.MPS(0)

        # self.drag_idx = 0
        # self.drags = []

        self.setConnects()

    def set(self, payload: a7p.Payload):
        """set input data to ballistic profile instance"""

        self._payload = payload
        prof = self._payload.profile
        self._z_d = Unit.METER(
            prof.distances[prof.c_zero_distance_idx] / 100
        )

        # self.z_x.setValue(prof.zero_x)
        # self.z_y.setValue(prof.zero_y)

        # if 'z_wind_angle' in data:
        #     self.z_wind_angle = Unit.DEGREE(data['z_wind_angle'], AngularDegree)
        # if 'z_wind_speed' in data:
        #     self.z_wind_speed = Velocity(data['z_wind_speed'], VelocityMPS)

        # self.drag_idx = data['drag_idx']
